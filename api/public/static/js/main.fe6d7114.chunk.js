(this["webpackJsonpmatcha-client"]=this["webpackJsonpmatcha-client"]||[]).push([[0],{108:function(e,t,a){e.exports=a(174)},115:function(e,t,a){},12:function(e,t){var a=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];localStorage.setItem("user",JSON.stringify({username:e,id:t,age:a,loggedIn:r,tags:n}))};e.exports={getUser:function(){return localStorage.getItem("user")||a("","",!1),JSON.parse(localStorage.getItem("user"))},setUser:a,getToken:function(){return localStorage.getItem("token")},setToken:function(e){return localStorage.setItem("token",e)}}},143:function(e,t){},146:function(e,t,a){},174:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(7),o=a.n(l),i=(a(115),a(1)),c=a(9),s=a(8),m=a(93),u=a.n(m),d=(a(146),function(e){var t=e.children,a=e.setPopupState;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.3)",position:"fixed",top:"0",left:"0",justifyContent:"center",alignItems:"center",zIndex:"22"}},r.a.createElement("div",{style:{display:"inline-block",width:"fit-content",height:"fit-content",maxHeight:"93%",maxWidth:"85%",backgroundColor:"white",position:"fixed",borderRadius:"10px",padding:"20px",textAlign:"center",top:"50%",left:"45%",transform:"translate(-50%, -50%)",zIndex:"998"}},t,r.a.createElement("button",{onClick:function(){a(!1)},style:{height:"27px",width:"27px",position:"absolute",top:"-15px",right:"-15px",backgroundColor:"white",borderRadius:"15px",border:"1px solid gray",boxShadow:"6px 6px 29px -1px rgba(0, 0, 0, 1)",cursor:"pointer",zIndex:"999"}},"X"))))}),p=function(e){var t=e.type,a=e.name,n=(e.label,e.state),l=(e.setState,e.eventHandler),o=e.step,i=void 0===o?1:o,c=e.pattern,s=e.required,m=e.max,u=e.min;return"textarea"===t?r.a.createElement("textarea",{name:a,className:"form-control",onChange:function(e){return l(e)},value:n||"",required:!!s}):"number"===t&&"undefined"!==typeof m&&"undefined"!==typeof u?r.a.createElement("input",{type:t,className:"form-control",name:a,value:n,onChange:function(e){return l(e)},step:i,min:u,max:m,required:s}):"number"===t?r.a.createElement("input",{type:t,className:"form-control",name:a,value:n,onChange:function(e){return l(e)},step:i,required:s}):"text"===t&&c?r.a.createElement("input",{type:t,className:"form-control",name:a,value:n,onChange:function(e){return l(e)},pattern:c,required:s}):r.a.createElement("input",{type:t,className:"form-control",name:a,value:n,onChange:function(e){return l(e)},required:s})},g=function(e){var t=e.type,a=e.name,n=e.label,l=e.state,o=e.setState,i=e.step,c=e.integer,s=e.pattern,m=e.required,u=e.max,d=e.min;return r.a.createElement("div",null,r.a.createElement("label",{htmlFor:a},n),r.a.createElement(p,{type:t,name:a,label:n,state:l,setState:o,eventHandler:function(e){c&&!Number.isInteger(Number(e.target.value))||o(e.target.value)},step:i,pattern:s,required:m,max:u,min:d}),r.a.createElement("br",null))},f=function(){var e=localStorage.getItem("coordinates");if(localStorage.removeItem("coordinates"),e){var t=JSON.parse(e);return{latitude:t.latitude,longitude:t.longitude}}return{latitude:null,longitude:null}},b=a(15),h=a.n(b),E=a(12),v=a(33),y=function(e,t){if("placeholder.png"===e||!e||"null"===e)return"/img/placeholder.png";return"undefined"===typeof t?"/img/userPhotos/"+e:"/img/userPhotos/"+e+"."+t},S=function(e){e.target.src=y("placeholder.png")},x=function(){return{Authorization:"Bearer ".concat(Object(E.getToken)())}},k=function(e){var t="/api"+e;return h.a.get(t,{headers:x()}).then((function(e){return"logged out"===e.data?void O(!0):e.data}))},O=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];localStorage.clear(),e&&(window.location.href="/")},j=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n="/api/logout",r=h.a.post(n,{all:a},{headers:x()});e({}),t.emit("logOut",{user:Object(E.getToken)()}),localStorage.clear(),r.then((function(e){return O(!0)}))},w=function(e,t,a,n){var r=h.a.post("/api/myProfile/photoActions",{action:e,id:t},{headers:x()});return"delete"===e&&window.location.reload(!1),r.then((function(e){return"logged out"===e.data?void O(!0):(n(!a),e.data)}))},N=function(e,t,a,n){var r="/api"+e,l="";l="block"===t?"block":"unblock"===t?"unblock":"report"===t?"report":t===v.a.noLikes||t===v.a.theyLike?"like":"unlike",h.a.post(r,{action:l},{headers:x()}).then((function(e){"logged out"!==e.data?n(!a):O(!0)}))},C=function(e,t,a){return e&&"email"!==e&&"Database error"!==e?(Object(E.setUser)(e.username,e.id,e.age,e.tags,!0),Object(E.setToken)(e.token),t({loggedIn:!0,username:e.username,id:e.id}),a(!1),window.location.href="/",!0):(t({}),localStorage.clear(),"email"===e?alert("Make sure to confirm your email address before logging in."):alert("Login failed."),!1)},P=function(e){e.state;var t=e.setState,a=e.setPopupState,l=Object(n.useState)(""),o=Object(i.a)(l,2),s=o[0],m=o[1],u=Object(n.useState)(""),p=Object(i.a)(u,2),b=p[0],E=p[1];return Object(n.useEffect)((function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(e){e.coords.longitude&&e.coords.latitude&&localStorage.setItem("coordinates",JSON.stringify({latitude:e.coords.latitude,longitude:e.coords.longitude}))}))}),[]),r.a.createElement(d,{setPopupState:a},r.a.createElement("form",{id:"loginForm",onSubmit:function(e){return function(e,t,a,n,r){e.preventDefault();var l=f(),o={username:n,password:r,latitude:l.latitude,longitude:l.longitude};h.a.post("/api/login",o).then((function(e){C(e.data,t,a)}))}(e,t,a,s,b)}},r.a.createElement(g,{type:"text",name:"username",label:"Username",state:s,setState:m}),r.a.createElement(g,{type:"password",name:"password",label:"Password",state:b,setState:E}),r.a.createElement("input",{style:{color:"white",fontWeight:"bold",backgroundColor:"#000050",padding:"5px 15px",boxShadow:"6px 6px 29px -4px rgba(0, 0, 0, 0.75)",borderRadius:"5px",marginTop:"25px",transition:"0.4s"},type:"submit",name:"submit",value:"OK"})),r.a.createElement(c.b,{to:"#",onClick:function(){return a("forgotPassword")}},"Forgot your password?"),r.a.createElement("div",null,r.a.createElement("a",{href:"https://api.intra.42.fr/oauth/authorize?client_id=932fc007009ee06ec98cba8f6d4842c092a26a18aef1875d5b7bc91d9308a7a0&redirect_uri=http%3A%2F%2Flocalhost%3A3000%2FapiLogin&response_type=code"},"Login with 42")))},F=function(e){var t=e.setPopupState,a=Object(n.useState)(""),l=Object(i.a)(a,2),o=l[0],c=l[1],s=Object(n.useState)(""),m=Object(i.a)(s,2),u=m[0],p=m[1],f=Object(n.useState)(""),b=Object(i.a)(f,2),E=b[0],v=b[1],y=Object(n.useState)(""),S=Object(i.a)(y,2),x=S[0],k=S[1],O=Object(n.useState)(""),j=Object(i.a)(O,2),w=j[0],N=j[1],C=Object(n.useState)(""),P=Object(i.a)(C,2),F=P[0],T=P[1];return Object(n.useEffect)((function(){var e=localStorage.getItem("registerPrefill");if(e){var t=JSON.parse(e);t.uname&&c(t.username),t.first_name&&N(t.first_name),t.last_name&&T(t.last_name),t.email&&k(t.email),localStorage.removeItem("registerPrefill")}}),[]),r.a.createElement(d,{setPopupState:t},r.a.createElement("form",{id:"registerForm",onSubmit:function(e){return function(e,t,a,n,r,l,o,i){e.preventDefault();var c={username:a,password:n,confirmPassword:r,email:l,firstName:o,lastName:i};h.a.post("/api/register",c).then((function(e){e.data?t(!1):alert("Failed to register an account.")}))}(e,t,o,u,E,x,w,F)}},r.a.createElement(g,{type:"text",name:"username",label:"Username",state:o,setState:c}),r.a.createElement(g,{type:"email",name:"email",label:"Email",state:x,setState:k}),r.a.createElement(g,{type:"text",name:"firstName",label:"First name",state:w,setState:N}),r.a.createElement(g,{type:"text",name:"lastName",label:"Last name",state:F,setState:T}),r.a.createElement(g,{type:"password",name:"password",label:"Password",state:u,setState:p}),r.a.createElement(g,{type:"password",name:"confirmPassword",label:"Confirm password",state:E,setState:v}),r.a.createElement("input",{type:"submit",name:"submit",value:"OK"})),r.a.createElement("div",null,r.a.createElement("a",{href:"https://api.intra.42.fr/oauth/authorize?client_id=932fc007009ee06ec98cba8f6d4842c092a26a18aef1875d5b7bc91d9308a7a0&redirect_uri=http%3A%2F%2Flocalhost%3A3000%2FapiRegister&response_type=code"},"Register with 42")))},T=function(e){e.state,e.setState;var t=e.setPopupState,a=Object(n.useState)(""),l=Object(i.a)(a,2),o=l[0],s=l[1];return r.a.createElement(d,{setPopupState:t},r.a.createElement("form",{id:"forgotPasswordForm",onSubmit:function(e){return function(e,t,a){e.preventDefault();var n={email:a};h.a.post("/api/forgotPassword",n).then((function(e){e.data?t(!1):alert("Something went wrong, nothing has been done.")}))}(e,t,o)}},r.a.createElement(g,{type:"email",name:"email",label:"Email",state:o,setState:s}),r.a.createElement("input",{type:"submit",name:"submit",value:"OK"})),r.a.createElement(c.b,{to:"#",onClick:function(){return t("login")}},"Back"))},D=function(e){e.state,e.setState;var t=e.setPopupState,a=Object(n.useState)(""),l=Object(i.a)(a,2),o=l[0],s=l[1],m=Object(n.useState)(""),u=Object(i.a)(m,2),p=u[0],f=u[1];return r.a.createElement(d,{setPopupState:t},r.a.createElement("form",{id:"forgotPasswordForm",onSubmit:function(e){return function(e,t,a,n){e.preventDefault(),h.a.post("/api/resetPassword",{password:a,confirmPassword:n}).then((function(e){e.data?t(!1):alert("Something went wrong")}))}(e,t,o,p)}},r.a.createElement(g,{type:"password",name:"password",label:"Password",state:o,setState:s}),r.a.createElement(g,{type:"password",name:"confirmPassword",label:"Confirm password",state:p,setState:f}),r.a.createElement("input",{type:"submit",name:"submit",value:"OK"})),r.a.createElement(c.b,{to:"#",onClick:function(){return t("login")}},"Back"))},L=a(40),A=a(26),R=a(95),I=function(e){var t=e.filename,a=e.style;return r.a.createElement("img",{alt:"User",src:y(t),onError:function(e){return S(e)},style:a||{}})},U=function(e){var t=e.notification,a="";return"visit"===t.reason?a="visited your profile!":"like"===t.reason?a="liked your profile!":"unlike"===t.reason?a="unliked you! :(":"msg"===t.reason&&(a="sent you a message!"),r.a.createElement("div",{style:Object(A.a)(Object(A.a)({},{backgroundColor:"lightgrey",padding:"0.5em",borderRadius:"1em",marginTop:"4px",marginBottom:"4px"}),{},{backgroundColor:t.read?"lightgrey":"lightblue"})},r.a.createElement(I,{filename:t.filename,style:{height:"50px",marginRight:"0.5em"}}),r.a.createElement("strong",null,t.username)," ",a)},W={display:"flex",backgroundColor:"slategrey",flexFlow:"column-reverse nowrap",padding:"0.5em",borderRadius:"1em"},_={maxHeight:"300px",flexFlow:"column nowrap",overflow:"auto",zIndex:9,position:"absolute"},M=function(e){e.unreadNotificationsCount;var t=e.setUnreadNotificationsCount,a=Object(n.useState)(!1),l=Object(i.a)(a,2),o=l[0],c=l[1],s=Object(n.useState)([]),m=Object(i.a)(s,2),u=m[0],d=m[1],p=Object(n.useState)(!1),g=Object(i.a)(p,2),f=g[0],b=g[1],h=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t="/myProfile/notifications",a=t+(e?"?read=1":"");k(a).then((function(e){e&&d(e)}))};Object(n.useEffect)((function(){setTimeout((function(){return h(!1)}),100)}),[]),Object(n.useEffect)((function(){k("/myProfile/longNotifications").then((function(e){e&&d((function(t){return[].concat(Object(L.a)(t),Object(L.a)(e))})),b(!f)}))}),[f]);var E=u.length?u.map((function(e){return r.a.createElement(U,{notification:e,key:e.id,new:!e.read})})):r.a.createElement("p",null,"Empty!"),v=u.filter((function(e){return!e.read})).length;return t(v),r.a.createElement(r.a.Fragment,null,r.a.createElement(R.a,{size:"sm",style:{position:"relative"},variant:"secondary",onClick:function(){return function(e,t){h(!t),e(!t)}(c,o)}},"Notifications",v?r.a.createElement(H,{count:v,right:"-3"}):""),r.a.createElement("div",{style:Object(A.a)(Object(A.a)({},_),{},{display:o?"flex":"none"})},r.a.createElement("div",{style:W},E)))},B=function(e){var t=e.state,a=e.setState,n=e.popupState,l=e.setPopupState,o=e.unreadNotificationsCount,i=e.setUnreadNotificationsCount,m=e.socketState,u=Object(s.f)();return t.loggedIn?r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",{className:"navbar-nav mr-auto"},r.a.createElement("li",{className:"nav-item nav-link"},r.a.createElement(c.b,{to:"/",style:"/"==u.pathname?{fontWeight:"bold"}:{}},"Home")),r.a.createElement("li",{className:"nav-item nav-link"},r.a.createElement(c.b,{to:"/myProfile/profile",style:"/myPro"==u.pathname.substr(0,6)?{fontWeight:"bold"}:{}},"Profile")),r.a.createElement("li",{className:"nav-item nav-link"},r.a.createElement(c.b,{to:"/map",style:"/map"==u.pathname?{fontWeight:"bold"}:{}},"User Map"))),r.a.createElement("ul",{className:"navbar-nav ml-auto"},r.a.createElement("li",{className:"nav-item nav-link"},t.username),r.a.createElement("li",{className:"nav-item nav-link"},r.a.createElement(M,{unreadNotificationsCount:o,setUnreadNotificationsCount:i})),r.a.createElement("li",{className:"nav-item nav-link"},r.a.createElement(c.b,{to:"#",onClick:function(){return j(a,m)}},"Log out")),r.a.createElement("li",{className:"nav-item nav-link"},r.a.createElement(c.b,{to:"#",onClick:function(){return j(a,m,!0)}},"Log out all instances")))):r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",{className:"navbar-nav mr-auto"},r.a.createElement("li",{className:"nav-item nav-link"},r.a.createElement(c.b,{to:"/"},"Home"))),r.a.createElement("ul",{className:"navbar-nav ml-auto"},r.a.createElement("li",{className:"nav-item nav-link"},r.a.createElement(c.b,{to:"#",onClick:function(){return l("login"!==n&&"login")}},"Log in")),r.a.createElement("li",{className:"nav-item nav-link"},r.a.createElement(c.b,{to:"#",onClick:function(){return l("register"!==n&&"register")}},"Register"))),"login"===n?r.a.createElement(P,{state:t,setState:a,setPopupState:l}):null,"register"===n?r.a.createElement(F,{state:t,setState:a,setPopupState:l}):null,"forgotPassword"===n?r.a.createElement(T,{state:t,setState:a,setPopupState:l}):null,"resetPassword"===n?r.a.createElement(D,{state:t,setState:a,setPopupState:l}):null)},H=function(e){var t=e.count,a=e.right,n={position:"absolute",top:"-3px",right:(void 0===a?"-10":a)+"px",backgroundColor:"red",color:"cyan",borderRadius:"50%",height:"12px",width:"12px"};return t?r.a.createElement("div",{style:n}):""},q=function(e){var t=Object(n.useState)(0),a=Object(i.a)(t,2),l=a[0],o=a[1];return r.a.createElement("nav",{className:"navbar navbar-expand-md navbar-light bg-light"},r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon",style:{position:"relative"}},r.a.createElement(H,{count:l}))),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent"},r.a.createElement(B,{state:e.state,setState:e.setState,popupState:e.popupState,setPopupState:e.setPopupState,unreadNotificationsCount:l,setUnreadNotificationsCount:o,socketState:e.socketState})))},z=function(e){var t=e.users,a=e.distanceFilter,n=e.minAge,l=e.maxAge,o=e.minCommonTags,i=e.sort,c=e.tagSearch;if(!t.length)return r.a.createElement("div",null,"There are currently no suggestions available for you!");var s=t.filter((function(e){return!(e.props.profile.distance>a)&&(!(e.props.profile.age<n)&&(!(e.props.profile.age>l)&&(!(e.props.profile.commonTags<o)&&(!c.length||e.props.profile.tags.includes(c)))))}));return s.length?s.sort((function(e,t){return(e.props.profile[i.key]-t.props.profile[i.key])*i.order})):r.a.createElement("div",null,"There are some profiles available for you, but the current filters are too strict!")},K=a(69),Y=(a(169),function(e){var t=e.distance,a=e.setDistance,l=e.minAge,o=e.setMinAge,c=e.maxAge,s=e.setMaxAge,m=e.minCommonTags,u=e.setMinCommonTags,d=e.sort,p=e.setSort,g=e.sortingMethods,f=(e.tagSearch,e.setTagSearch),b=Object(n.useState)(""),h=Object(i.a)(b,2),E=h[0],v=h[1],y=Object(n.useState)(t),S=Object(i.a)(y,2),x=S[0],k=S[1],O=g.map((function(e,t){return r.a.createElement("option",{value:t,key:e.name},e.display)}));return r.a.createElement("div",{style:{padding:"15px"}},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"sort"},"Sort by:"),r.a.createElement("select",{className:"custom-select",name:"sort",value:d,onChange:function(e){return p(e.target.value)}},O)),r.a.createElement("br",null),r.a.createElement("label",{htmlFor:"distance"},"Maximum distance: ",x," km"),r.a.createElement(K.b,{step:1,value:t,min:0,max:501,onChange:function(e){return function(e,t){t(e),k(e),501===e&&(t(99999),k("500+"))}(e,a)}})," ",r.a.createElement("br",null),r.a.createElement("div",null,"Age range: ",l," - ",c),r.a.createElement(K.a,{step:1,value:[l,c],min:16,max:99,onChange:function(e){return function(e,t,a){t(e[0]),a(e[1])}(e,o,s)}})," ",r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"minCommonTags"},"Minimum common tags"),r.a.createElement("select",{className:"form-control",type:"number",name:"minCommonTags",value:m,onChange:function(e){return function(e,t){t(e.target.value)}(e,u)}},r.a.createElement("option",null,"0"),r.a.createElement("option",null,"1"),r.a.createElement("option",null,"2"),r.a.createElement("option",null,"3"),r.a.createElement("option",null,"4"),r.a.createElement("option",null,"5")))," ",r.a.createElement("br",null),r.a.createElement("label",{htmlFor:"tagSearch"},"Tag search"),r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"","aria-label":"","aria-describedby":"basic-addon1",name:"tagSearch",value:"#"+E,onChange:function(e){return function(e,t){t(e.target.value.replace(/[#+]/g,""))}(e,v)}}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{className:"btn btn-primary",type:"button",onClick:function(){return f(E)}},"Search")),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{className:"btn btn-danger",type:"button",onClick:function(){f(""),v("")}},"Reset"))))}),J=function(e){var t=e.tag;return r.a.createElement("div",null,"#",t)},G=function(e){var t=e.profile,a=e.preview,n=t.commonTagsList.map((function(e,t){return r.a.createElement(J,{key:t,tag:e})}));return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{style:{background:"lightGray",color:"inherit",border:"none",padding:"0",font:"inherit",cursor:"pointer",outline:"inherit",marginBottom:"10px",marginTop:"20px",width:"100%",borderRadius:"20px",boxShadow:"0 0 5px 10px lightGray"},onClick:function(){a(t.id)}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("img",{alt:"User",src:y(t.filename),onError:function(e){return S(e)},style:{maxHeight:"100px",borderRadius:"50px",margin:"10px",border:"1px solid black"}}),r.a.createElement("h3",{key:t.id,style:{textAlign:"center"}},t.first_name,", ",t.age),r.a.createElement("h5",{style:{textAlign:"center",color:"rgb(80,80,80)",fontStyle:"italic"}},t.username),t.online?r.a.createElement("h6",{style:{color:"green"}},"Online!"):r.a.createElement("h6",{style:{color:"red"}},"Offline")),r.a.createElement("div",{className:"col-sm-6",style:{justifyContent:"center",alignItems:"center"}},t.distance<1?r.a.createElement("p",{style:{color:"green"}},"Very close to you!"):t.distance<10?r.a.createElement("p",{style:{color:"yellow"}},"In the same city"):r.a.createElement("p",{style:{color:"red"}},"In another city"),r.a.createElement("p",{style:{display:"inline"}},"Distance: ",t.distance<1?"less than a ":Number(t.distance.toFixed(0))," ")," ",r.a.createElement("p",{style:{display:"inline"}},"km"),t.commonTags?r.a.createElement("div",null,t.first_name," is also interested in: ",n):r.a.createElement("div",{style:{fontStyle:"italic",color:"rgb(100,100,100)"}},"No common interests")))),r.a.createElement("br",null))},V=function(e){var t=e.user,a=e.stateChange,l=e.setStateChange,o=Object(n.useState)(t),c=Object(i.a)(o,2),s=c[0],m=c[1];s&&s.blockStatus;var u={maxWidth:"120px",maxHeight:"100px",padding:"20px"},p={background:"none",color:"inherit",border:"none",padding:"0",font:"inherit",cursor:"pointer",outline:"inherit"},g=Object(n.useState)(null),f=Object(i.a)(g,2),b=f[0],h=f[1],E=Object(n.useState)(!1),v=Object(i.a)(E,2),S=v[0],x=v[1],O=Object(n.useState)(!1),j=Object(i.a)(O,2),w=j[0],C=j[1];if(Object(n.useEffect)((function(){t&&k("/profile/"+t.profileData.id).then((function(e){m(e)}))}),[t,w]),s&&s.profileData.last_login)var P=s.profileData.last_login.split(".")[0].split("T")[0].split("-").reverse().join("."),F=s.profileData.last_login.split(".")[0].split("T")[1].split(":")[0]+":"+s.profileData.last_login.split(".")[0].split("T")[1].split(":")[1];else P="never",F="";return s?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{margin:"20px",justifyContent:"center",textAlign:"center",paddingTop:"10px",zIndex:"-1",backgroundColor:"lightgray",borderRadius:"170px",boxShadow:"0 0 25px 40px lightGray"}},s&&s.profileData?r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,s.profileData.username,", ",s.profileData.age),r.a.createElement("h6",null,s.profileData.online?"Online":"Last online: "+(P+" "+F||"never")),r.a.createElement("h6",{style:{color:"red"}},"Fame: ",s.profileData.fame),s&&!0===s.blockStatus?r.a.createElement("h1",{style:{position:"relative",top:"14px",textAlign:"center",fontWeight:"bolder",fontSize:"60px",color:"red"}},"BLOCKED"):"",r.a.createElement("div",{style:{width:"100%"}},r.a.createElement("button",{onClick:function(){h(s.profileData.filename),x(!0)},style:p},r.a.createElement("img",{src:y(s.profileData.filename),style:{maxWidth:"100%",maxHeight:"100%",borderRadius:"100px"}}))),s.images.map((function(e,t){return r.a.createElement("div",{key:t,style:{display:"inline"}},e!==s.profileData.filename?r.a.createElement("button",{onClick:function(){h(e),x(!0)},style:p},r.a.createElement("img",{src:y(e),style:u})):null)})),r.a.createElement("p",{style:{overflowWrap:"break-word"}},s.profileData.biography)," ",r.a.createElement("br",null),s.profileData.tags_string?r.a.createElement(r.a.Fragment,null,s.profileData.tags_string.split(",").map((function(e,t){return r.a.createElement("h5",{key:t,style:{display:"inline",color:"red",overflowWrap:"break-word"}},"  #",e)}))," ",r.a.createElement("br",null)):"",s&&!1===s.blockStatus?r.a.createElement("button",{onClick:function(){N("/profile/"+s.profileData.id,s.likeButton,w,C),l(!a)},className:"btn btn-success"},s.likeButton):"",s?r.a.createElement("button",{onClick:function(){N("/profile/"+s.profileData.id,!0===s.blockStatus?"unblock":"block",w,C),l(!a)},className:"btn btn-danger"},!0===s.blockStatus?"Unblock user":"Block user"):""," ",r.a.createElement("br",null),s?r.a.createElement("button",{style:{margin:"9px",height:"70%"},onClick:function(){confirm("Do you really want to report this user?")&&(N("/profile/"+s.profileData.id,"report",w,C),l(!a))},className:"btn btn-danger btn-sm",disabled:s.reportStatus}," ",!1===s.reportStatus?"Report user":"reported"):""):null,!0===S?r.a.createElement(d,{setPopupState:x},r.a.createElement("img",{src:y(b),style:{maxWidth:"100%",maxHeight:"100%",Zindex:"23"}})):"")):""},X=a(104),Z=function(e){var t=e.state,a=e.action,l=e.setPopupState,o=e.setState,c=Object(E.getUser)(),s=c.age?c.age:25,m=Object(n.useState)([]),u=Object(i.a)(m,2),d=u[0],p=u[1],g=Object(n.useState)(100),b=Object(i.a)(g,2),y=b[0],S=b[1],x=Object(n.useState)(s-3),O=Object(i.a)(x,2),j=O[0],w=O[1],N=Object(n.useState)(s+3),P=Object(i.a)(N,2),F=P[0],T=P[1],D=Object(n.useState)(0),L=Object(i.a)(D,2),A=L[0],R=L[1],I=Object(n.useState)(0),U=Object(i.a)(I,2),W=U[0],_=U[1],M=Object(n.useState)(""),B=Object(i.a)(M,2),H=B[0],q=B[1],K=Object(n.useState)(null),J=Object(i.a)(K,2),Z=J[0],Q=J[1],$=Object(n.useState)(null),ee=Object(i.a)($,2),te=ee[0],ae=ee[1],ne=Object(n.useState)(!1),re=Object(i.a)(ne,2),le=re[0],oe=re[1];"resetPassword"===a&&l("resetPassword");return Object(n.useEffect)((function(){if("confirmEmail"===a){var e=function(e){if(e.length<2)return null;var t=e.substring(1).split("&"),a={};return t.forEach((function(e){2===e.split("=").length&&(a[e.split("=")[0]]=e.split("=")[1])})),a}(window.location.search);if(!e||!e.user||!e.token)return;t=e,n=a,void h.a.post("/api/"+n,t).then((function(e){return!!e.data||(alert("Something went wrong, nothing has been done."),!1)}))&&(l("login"),window.location.href="/")}else if("apiLogin"!==a&&"apiRegister"!==a||!window.location.search)a||k(window.location.pathname).then((function(e){p(function(e){return e&&e.length?e.map((function(e){return r.a.createElement(G,{key:e.id,profile:e,preview:Q})})):""}(e=e||[]))}));else{"?code="!==window.location.search.substr(0,6)&&(window.location.href="/"),function(e,t){var a={};"apiLogin"===t&&(a=f());var n="/api/"+t,r=h.a.post(n,{code:e,latitude:a.latitude,longitude:a.longitude});return new Promise((function(e,t){r.then((function(t){return e(t.data)}))}))}(window.location.search.substr(6),a).then((function(e){e&&"register"===e.action?(localStorage.setItem("registerPrefill",JSON.stringify(e)),l("register")):C(e,o,l)}))}var t,n;Z&&k("/profile/"+Z).then((function(e){ae(e)}))}),[a,l,Z,le]),t.loggedIn?r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6 h-25 order-md-2",id:"searchContainer"},r.a.createElement(X.a,{id:"dropdown-basic-button",title:"Filters"},r.a.createElement(Y,{distance:y,setDistance:S,minAge:j,setMinAge:w,maxAge:F,setMaxAge:T,minCommonTags:A,setMinCommonTags:R,sort:W,setSort:_,sortingMethods:v.b,tagSearch:H,setTagSearch:q})),r.a.createElement("div",{style:{marginTop:"10px"}},r.a.createElement(V,{user:te,stateChange:le,setStateChange:oe}),r.a.createElement("br",null))),r.a.createElement("div",{className:"col-md-6 h-25 order-md-1",id:"suggestionContainer"},r.a.createElement("div",{className:"container",style:{overflowY:"auto",maxHeight:"700px"}},r.a.createElement(z,{users:d,distanceFilter:y,minAge:j,maxAge:F,minCommonTags:A,sort:v.b[W],tagSearch:H})),r.a.createElement("br",null),r.a.createElement("br",null)))):r.a.createElement("div",null,"Log in")},Q=function(){return r.a.createElement("nav",{className:"navbar navbar-expand navbar-light bg-light"},r.a.createElement("div",{className:"navbar-nav"},r.a.createElement("div",{className:"navbar-nav"},r.a.createElement(c.b,{className:"nav-item nav-link",to:"/myProfile/profile"},"Profile"),r.a.createElement(c.b,{className:"nav-item nav-link",to:"/myProfile/likes"},"Likes"),r.a.createElement(c.b,{className:"nav-item nav-link",to:"/myProfile/visits"},"Visits"))))},$=function(e){var t=e.name,a=e.state,n=e.setState,l=e.options,o=e.required;return l.map((function(e){return e.checked||(e.checked=function(t,a){return t===e.value}),r.a.createElement("span",{key:e.value+e.label},r.a.createElement("div",{className:"custom-control custom-radio",style:{display:"inline"}},r.a.createElement("input",{type:"radio",name:t,value:e.value,checked:e.checked(a,e.value),onChange:function(e){return function(e){n(e.target.value)}(e)},required:o}),r.a.createElement("label",{htmlFor:e.value,style:{paddingLeft:"0.2em"}},e.label)))}))},ee=function(e){var t=e.tag,a=e.index,n=e.tagRemoval;return r.a.createElement("div",{style:{display:"block",marginRight:"0.5em",marginLeft:"0.5em"}},r.a.createElement(R.a,{style:{backgroundColor:a%2?"gainsboro":"darkgray",color:"black",borderColor:a%2?"darkgray":"gainsboro"}},"#",t),r.a.createElement(R.a,{variant:"danger",id:"tagRemovalId"+a,onClick:function(e){return n(e)}},"X"))},te=function(e){var t=e.tags,a=e.setTags,l=Object(n.useState)(""),o=Object(i.a)(l,2),c=o[0],s=o[1],m=function(e){a(t.filter((function(t,a){return e.target.id!=="tagRemovalId"+a})))},u=t.map((function(e,t){return r.a.createElement(ee,{tag:e,index:t,tagRemoval:m,key:e+t})}));return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex",flexFlow:"row wrap"}},u),r.a.createElement("br",null),r.a.createElement("div",{className:"input-group",style:{marginTop:"0.5em"}},r.a.createElement("span",{style:{position:"relative",left:"20px"}},"#"),r.a.createElement("input",{type:"text",className:"form-control",placeholder:"","aria-label":"","aria-describedby":"basic-addon1",value:"#"+c,onChange:function(e){return s(e.target.value.replace(/[#+]/g,""))}}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{className:"btn btn-success",type:"button",onClick:function(){c.length&&(a([].concat(Object(L.a)(t),[c])),s(""))}},"Add!"))),r.a.createElement("br",null))},ae=a(24),ne=a(51),re={width:"100%",height:"400px"},le=function(e){var t=e.lat,a=e.lon,l=e.setLat,o=e.setLon,c=Object(n.useState)({lat:0,lng:0}),s=Object(i.a)(c,2),m=s[0],u=s[1];Object(n.useEffect)((function(){u({lat:parseFloat(t),lng:parseFloat(a)})}),[t,a]);return r.a.createElement(ae.b,{googleMapsApiKey:ne.a},r.a.createElement(ae.a,{mapContainerStyle:re,center:m,zoom:6},r.a.createElement(ae.c,{draggable:!0,position:m,onDragEnd:function(e){return function(e){l(e.latLng.lat()),o(e.latLng.lng())}(e)}})))},oe=function(e){var t=e.rerenderTrick,a=e.setRerenderTrick,n=e.firstName,l=e.setFirstName,o=e.lastName,i=e.setLastName,c=e.age,s=e.setAge,m=e.latitude,u=e.setLatitude,d=e.longitude,p=e.setLongitude,f=e.email,b=e.setEmail,v=e.gender,y=e.setGender,S=e.target,k=e.setTarget,j=e.biography,w=e.setBiography,N=e.tags,C=e.setTags,P=e.myProfileSaveStatus,F=e.setMyProfileSaveStatus;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Your information"),r.a.createElement("form",{id:"myProfileForm",onSubmit:function(e){return function(e,t,a,n,r,l,o,i,c,s,m,u,d,p){if(e.preventDefault(),e.target.checkValidity()){var g={firstName:t,lastName:a,age:n,latitude:r,longitude:l,email:o,gender:i,target:c,biography:s,tags:m};return h.a.post("/api/myProfile/profile",g,{headers:x()}).then((function(e){"logged out"!==e.data?(d(!u),e.data&&e.data.token?(Object(E.setToken)(e.data.token),p("OK")):p("Error, changes not saved")):O(!0)}))}e.target.reportValidity()}(e,n,o,c,m,d,f,v,S,j,N,t,a,F)}},r.a.createElement(g,{type:"text",name:"firstName",label:"First name",state:n,setState:l,pattern:"[\\p{L}\\-']{2,32}",required:!0}),r.a.createElement(g,{type:"text",name:"lastName",label:"Last name",state:o,setState:i,pattern:"[\\p{L}\\-']{2,32}",required:!0}),r.a.createElement(g,{type:"email",name:"email",label:"Email",state:f,setState:b,required:!0}),r.a.createElement(g,{type:"text",name:"age",label:"Age",state:c,setState:s,required:!0,pattern:"(1[6-9])|([2-9][0-9])"}),r.a.createElement("div",null,"Location"),r.a.createElement(le,{lat:m,lon:d,setLat:u,setLon:p}),r.a.createElement("div",null,"Gender"),r.a.createElement($,{name:"gender",state:v,setState:y,options:[{label:"Man",value:"m"},{label:"Woman",value:"f"}],required:!0}),"  ",r.a.createElement("br",null),r.a.createElement("div",null,"Looking for"),r.a.createElement($,{name:"target",state:S,setState:k,options:[{label:"Men",value:"m"},{label:"Both",value:"fm",checked:function(e,t){return 2===e.length}},{label:"Women",value:"f"}],required:!0})," ",r.a.createElement("br",null),r.a.createElement(g,{type:"textarea",name:"biography",label:"Biography",state:j,setState:w,required:!0}),r.a.createElement("div",null,"Tags"),r.a.createElement(te,{tags:N,setTags:C}),2===P.length?r.a.createElement("div",{className:"alert alert-success"},P):P.length?r.a.createElement("div",{className:"alert alert-danger"},P):"",r.a.createElement("input",{className:"button btn btn-primary",type:"submit",name:"submit",value:"Save",style:{marginLeft:"50%",marginRight:"50%",marginBottom:"1em"}})))},ie=a(179),ce=a(180),se=function(e){var t=e.photo,a=e.previewImage,n=e.popupState,l=e.main_pic,o=e.rerenderTrick,i=e.setRerenderTrick,c=!1,s={maxWidth:"300px",maxHeight:"300px"};return t.id===l&&(c=!0,s=Object(A.a)(Object(A.a)({},s),{},{boxShadow:"0 0 20px 10px lightsteelblue",marginBottom:"10px",marginTop:"10px"})),r.a.createElement(ie.a,null,r.a.createElement(ce.a,{className:"justify-content-center",style:{marginBottom:"10px"}},r.a.createElement("div",{onClick:function(){a(t.id),n(!0)}},r.a.createElement("img",{alt:"Your upload",src:y(t.id,t.extension),style:s}))),r.a.createElement(ce.a,{className:"justify-content-center",style:{marginBottom:"30px"}},r.a.createElement(R.a,{className:"btn",disabled:c,onClick:function(){return w("primary",t.id,o,i)},style:{marginRight:"15px"}},"Make photo primary"),r.a.createElement(R.a,{className:"btn btn-danger",disabled:c,onClick:function(){return w("delete",t.id,o,i)}},"Delete photo")))},me=function(e){var t=e.profile,a=e.rerenderTrick,l=e.setRerenderTrick,o=Object(n.useState)(null),c=Object(i.a)(o,2),s=c[0],m=c[1],u=Object(n.useState)(!1),p=Object(i.a)(u,2),g=p[0],f=p[1],b=function(e,t,a){(function(e){var t=new FormData;return Array.prototype.forEach.call(e,(function(e){t.append("photos",e)})),h.a.post("/api/myProfile/pics",t,{headers:x()}).then((function(e){return"logged out"===e.data?void O(!0):e.data}))})(e.target.files).then((function(e){return a(!t)}))},E=t.images.length?t.images.map((function(e){return r.a.createElement(se,{photo:e,key:e.id,previewImage:m,popupState:f,main_pic:t.userData.main_pic,rerenderTrick:a,setRerenderTrick:l})})).sort((function(e,t){return e.key==e.props.main_pic||t.key==t.props.main_pic?(t.key==t.props.main_pic)-(e.key==e.props.main_pic):e.key-t.key})):r.a.createElement("p",null,"You haven't uploaded any images!");return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Your photos"),r.a.createElement("div",{className:"custom-file"},r.a.createElement("input",{type:"file",name:"photoUpload",className:"form-control-file",id:"exampleFormControlFile1",onChange:function(e){return b(e,a,l)},multiple:!0,accept:"image/*"}),r.a.createElement("label",{className:"custom-file-label",htmlFor:"exampleFormControlFile1","data-browse":"Upload"},"Upload photos")),r.a.createElement("h2",null,"Uploaded photos (",t.images.length,"/5)"),E,!0===g?r.a.createElement(d,{setPopupState:f},r.a.createElement("img",{src:y(s,"png"),style:{maxWidth:"100%",maxHeight:"100%"},alt:"Enlarged profile"})):"")},ue=function(e){e.state,e.setState;var t=Object(n.useState)(!1),a=Object(i.a)(t,2),l=a[0],o=a[1],c=Object(n.useState)(null),s=Object(i.a)(c,2),m=s[0],u=s[1],d=Object(n.useState)(""),p=Object(i.a)(d,2),g=p[0],f=p[1],b=Object(n.useState)(""),h=Object(i.a)(b,2),E=h[0],v=h[1],y=Object(n.useState)(16),S=Object(i.a)(y,2),x=S[0],O=S[1],j=Object(n.useState)(0),w=Object(i.a)(j,2),N=w[0],C=w[1],P=Object(n.useState)(0),F=Object(i.a)(P,2),T=F[0],D=F[1],L=Object(n.useState)(""),A=Object(i.a)(L,2),R=A[0],I=A[1],U=Object(n.useState)("f"),W=Object(i.a)(U,2),_=W[0],M=W[1],B=Object(n.useState)("fm"),H=Object(i.a)(B,2),q=H[0],z=H[1],K=Object(n.useState)(""),Y=Object(i.a)(K,2),J=Y[0],G=Y[1],V=Object(n.useState)([]),X=Object(i.a)(V,2),Z=X[0],$=X[1],ee=Object(n.useState)(""),te=Object(i.a)(ee,2),ae=te[0],ne=te[1];return Object(n.useEffect)((function(){k(window.location.pathname).then((function(e){u(e),f(e.userData.first_name),v(e.userData.last_name),O(e.userData.age||"Unknown"),C(e.userData.latitude),D(e.userData.longitude),I(e.userData.email),M(e.userData.gender),z(e.userData.target_genders),G(e.userData.biography),$(e.tags)}))}),[l]),m?r.a.createElement(r.a.Fragment,null,r.a.createElement(Q,null),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-6"},r.a.createElement(oe,{rerenderTrick:l,setRerenderTrick:o,age:x,setAge:O,firstName:g,setFirstName:f,lastName:E,setLastName:v,latitude:N,setLatitude:C,longitude:T,setLongitude:D,email:R,setEmail:I,gender:_,setGender:M,target:q,setTarget:z,biography:J,setBiography:G,tags:Z,setTags:$,myProfileSaveStatus:ae,setMyProfileSaveStatus:ne})),r.a.createElement("div",{className:"col-sm-6"},r.a.createElement(me,{profile:m,rerenderTrick:l,setRerenderTrick:o})))):r.a.createElement(r.a.Fragment,null,r.a.createElement(Q,null),r.a.createElement("h1",null,"My profile"))},de=a(54),pe=a(35),ge=function(e){var t=e.likes,a=e.modifyPreview,n=e.modifyWho,l=(e.rerenderTrick,{height:"30px"});return t?t.map((function(e,t){return r.a.createElement("div",{key:t},r.a.createElement("button",{className:"btn btn-success",onClick:function(){var t;(t=e).likee?k("/profile/"+t.likee).then((function(e){a(e)})):k("/profile/"+t.visitee).then((function(e){a(e)})),a(e),n(1)},style:{width:"80%",marginRight:"50px",marginBottom:"20px"}},e.visiteePic?r.a.createElement("img",{src:y(e.visiteePhoto),style:l}):r.a.createElement("img",{src:y(e.likeePhoto),style:l}),r.a.createElement("b",null,"  ",e.likeeUsername?e.likeeUsername:e.visiteeUsername)),r.a.createElement("br",null))})):r.a.createElement("h1",null,"Loading")},fe=function(e){var t=e.likes,a=e.modifyPreview,n=e.modifyWho,l={height:"30px"};return t?t.map((function(e,t){return r.a.createElement("div",{key:t},r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"btn btn-success",onClick:function(){var t;(t=e).liker?k("/profile/"+t.liker).then((function(e){a(e)})):k("/profile/"+t.visitor).then((function(e){a(e)})),a(e),n(2)},style:{width:"80%",marginRight:"50px",marginBottom:"20px"}},e.visitorPic?r.a.createElement("img",{src:y(e.visitorPhoto),style:l}):r.a.createElement("img",{src:y(e.likerPhoto),style:l}),r.a.createElement("b",null,"  ",e.likerUsername?e.likerUsername:e.visitorUsername)),r.a.createElement("br",null)))})):r.a.createElement("h1",null,"Loading")},be=function(e){e.state,e.setState;var t=Object(n.useState)(null),a=Object(i.a)(t,2),l=a[0],o=a[1],c=Object(n.useState)(null),s=Object(i.a)(c,2),m=s[0],u=s[1],p=Object(n.useState)(null),g=Object(i.a)(p,2),f=(g[0],g[1]),b=Object(n.useState)(null),h=Object(i.a)(b,2),E=h[0],v=(h[1],Object(n.useState)(!1)),S=Object(i.a)(v,2),x=S[0],O=S[1],j=Object(n.useState)(!1),w=Object(i.a)(j,2),N=w[0],C=w[1];m&&m.blockStatus;return Object(n.useEffect)((function(){k(window.location.pathname).then((function(e){o(e)})),m&&k("/profile/"+m.profileData.id).then((function(e){u(e)}))}),[N]),l?r.a.createElement(r.a.Fragment,null,r.a.createElement(Q,null),r.a.createElement("h1",null,"Likes"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-6"},r.a.createElement(de.a,{defaultActiveKey:"profile",id:"uncontrolled-tab-example",className:"w-80",style:{margin:"20px"}},r.a.createElement(pe.a,{eventKey:"home",title:"Users you have liked",className:"w-80",style:{margin:"20px",maxHeight:"800px",overflowY:"auto"}},r.a.createElement(ge,{likes:l.liked,modifyPreview:u,modifyWho:f,render:N})),r.a.createElement(pe.a,{eventKey:"profile",title:"Users that have liked you",className:"w-80",style:{margin:"20px",maxHeight:"800px",overflowY:"auto"}},r.a.createElement(fe,{likes:l.likedMe,modifyPreview:u,modifyWho:f})))),r.a.createElement("div",{className:"col-sm-5",style:{margin:"20px",justifyContent:"center",textAlign:"center",paddingTop:"10px"}},m&&m.profileData?r.a.createElement(V,{user:m,stateChange:N,setStateChange:C}):"",!0===x?r.a.createElement(d,{setPopupState:O},r.a.createElement("img",{src:y(E),style:{maxWidth:"100%",maxHeight:"100%"}})):"")),r.a.createElement("br",null),r.a.createElement("br",null)):r.a.createElement(r.a.Fragment,null,r.a.createElement(Q,null),r.a.createElement("h1",null,"Profile empty or loading"),r.a.createElement("h1",null,"Serverille 'myProfile/likes'"))},he=function(e){e.state,e.setState;var t=Object(n.useState)(null),a=Object(i.a)(t,2),l=a[0],o=a[1],c=Object(n.useState)(null),s=Object(i.a)(c,2),m=s[0],u=s[1],p=Object(n.useState)(null),g=Object(i.a)(p,2),f=(g[0],g[1]),b=Object(n.useState)(null),h=Object(i.a)(b,2),E=h[0],v=(h[1],Object(n.useState)(!1)),S=Object(i.a)(v,2),x=S[0],O=S[1],j=Object(n.useState)(!1),w=Object(i.a)(j,2),N=w[0],C=w[1];m&&m.blockStatus;return Object(n.useEffect)((function(){k(window.location.pathname).then((function(e){o(e)})),m&&k("/profile/"+m.profileData.id).then((function(e){u(e)}))}),[N]),l?r.a.createElement(r.a.Fragment,null,r.a.createElement(Q,null),r.a.createElement("h1",null,"Visits"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-6"},r.a.createElement(de.a,{defaultActiveKey:"profile",id:"uncontrolled-tab-example",className:"w-80",style:{margin:"20px"}},r.a.createElement(pe.a,{eventKey:"home",title:"Users you have visited",className:"w-80",style:{margin:"20px",maxHeight:"800px",overflowY:"auto"}},r.a.createElement(ge,{likes:l.visited,modifyPreview:u,modifyWho:f})),r.a.createElement(pe.a,{eventKey:"profile",title:"Users that have visited you",className:"w-80",style:{margin:"20px",maxHeight:"800px",overflowY:"auto"}},r.a.createElement(fe,{likes:l.visitedMe,modifyPreview:u,modifyWho:f})))),r.a.createElement("div",{className:"col-sm-5",style:{margin:"20px",justifyContent:"center",textAlign:"center"}},m&&m.profileData?r.a.createElement(V,{user:m,stateChange:N,setStateChange:C}):"",!0===x?r.a.createElement(d,{setPopupState:O},r.a.createElement("img",{src:y(E),style:{maxWidth:"100%",maxHeight:"100%"}})):"")),r.a.createElement("br",null),r.a.createElement("br",null)):r.a.createElement(r.a.Fragment,null,r.a.createElement(Q,null),r.a.createElement("h1",null,"Profile empty or loading"),r.a.createElement("h1",null,"Serverille 'myProfile/likes'"))},Ee=function(e){return e+.05*(Math.random()-.5)},ve=function(e){var t=e.lat,a=e.lon,n=Ee(t),l=Ee(a),o=Math.abs(n),i=Math.abs(l),c={lat:o>90?89.99*o/n:n,lng:i>180?179.99*i/l:l};return r.a.createElement(ae.c,{position:c,clickable:!1})},ye={width:"100%",height:"90vh",margin:"auto"},Se=function(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),a=t[0],l=t[1],o=Object(n.useState)({lat:0,lng:0}),c=Object(i.a)(o,2),s=c[0],m=c[1];Object(n.useEffect)((function(){k("/map").then((function(e){e&&(m({lat:e.lat,lng:e.lon}),l(e.locations))}))}),[]);var u=a.map((function(e,t){return r.a.createElement(ve,{lat:e.latitude,lon:e.longitude,key:t})}));return a.length?r.a.createElement(ae.b,{googleMapsApiKey:ne.a},r.a.createElement(ae.a,{mapContainerStyle:ye,center:s,zoom:6},u)):"Couldn't load user locations!"},xe=function(e){var t=e.connections,a=e.chat,n=e.setChat,l=e.chatWindow,o=e.setChatWindow,i=e.setChatUsername;return t.map((function(e){return r.a.createElement("div",{key:e.username},e.online?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"btn btn-secondary",style:{width:"100%",marginBottom:"3px",justifyContent:"center"},onClick:function(){i(e.username),n(e.id),a===e.id?o(!l):o(null===a?!l:1==l?l:!l)}},r.a.createElement("img",{src:y(e.filename),style:{maxHeight:"30px"}}),r.a.createElement("h4",{style:{color:"white",display:"inline"}},"  ",e.username," "),r.a.createElement("div",{style:{backgroundColor:"green",height:"10px",width:"10px",borderRadius:"5px",display:"inline-block"}})),r.a.createElement("br",null)):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"btn btn-secondary",style:{width:"100%",marginBottom:"3px",justifyContent:"center"},onClick:function(){i(e.username),n(e.id),a===e.id?o(!l):o(null===a?!l:1==l?l:!l)}},r.a.createElement("img",{src:y(e.filename),style:{maxHeight:"30px"}}),r.a.createElement("h4",{style:{color:"white",display:"inline"}},"  ",e.username," "),r.a.createElement("div",{style:{backgroundColor:"red",height:"10px",width:"10px",borderRadius:"5px",display:"inline-block"}})),r.a.createElement("br",null)))}))},ke=function(e){var t=e.messages,a=e.otherUser;if("blocked"==e.mostRecentMessage&&alert("Both users must like eachother before messaging is possible!"),t){var n=0,l=0;return t.map((function(e,t){return l=n,n=a==e.sender_name?1:2,r.a.createElement("div",{key:t},1===n?r.a.createElement(r.a.Fragment,null,n!==l?r.a.createElement("h5",{style:{textAlign:"left"}},a):"",r.a.createElement("p",{style:{textAlign:"left"}},e.content)):r.a.createElement(r.a.Fragment,null,n!==l?r.a.createElement("h5",{style:{textAlign:"right"}},e.sender_name):"",r.a.createElement("p",{style:{textAlign:"right"}},e.content)))}))}return r.a.createElement("p",null,"No messages")},Oe=function(e){var t=e.socket,a=e.chat,l=e.chatWindow,o=e.chatUsername,c=Object(n.useState)(null),s=Object(i.a)(c,2),m=s[0],u=s[1],d=Object(n.useState)(null),p=Object(i.a)(d,2),g=p[0],f=p[1],b=Object(E.getToken)();function h(){var e=document.getElementById("message").value;e&&(t.emit("chat",{msg:e,id:a,me:b},(function(e){})),document.getElementById("message").value="")}return t.emit("privateChat",{user:a,me:b}),Object(n.useEffect)((function(){k("/chat?id=".concat(a)).then((function(e){e&&u(e)}))}),[l,a,g]),t.on("FromClient",{message:"asd"}),t.on("chat",(function(e){"block"==e.error?f("blocked"):f(e)})),r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"btn btn-primary",onClick:function(){return h()}},"Send"),r.a.createElement("input",{type:"text",className:"form-control",placeholder:"","aria-label":"","aria-describedby":"basic-addon1",name:"msg",id:"message",autoComplete:"off",onKeyPress:function(e){13===(e.keyCode||e.which)&&h()}.bind(void 0)}),r.a.createElement("div",{style:{display:"flex",flexDirection:"column-reverse",overflowY:"auto"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"column",overflowWrap:"break-word",padding:"4px"}},r.a.createElement(ke,{messages:m,otherUser:o,mostRecentMessage:g}))))},je=function(e){var t=e.socket,a=Object(n.useState)(!1),l=Object(i.a)(a,2),o=l[0],c=l[1],s=Object(n.useState)(null),m=Object(i.a)(s,2),u=m[0],d=m[1],p=Object(n.useState)(!0),g=Object(i.a)(p,2),f=g[0],b=g[1],E=Object(n.useState)(null),v=Object(i.a)(E,2),y=v[0],S=v[1],O=Object(n.useState)(null),j=Object(i.a)(O,2),w=j[0],N=j[1],C=Object(n.useState)(!1),P=Object(i.a)(C,2),F=P[0],T=P[1];return Object(n.useEffect)((function(){h.a.get("/api/getConnections",{headers:x()}).then((function(e){if(e.data&&"logged out"!==e.data)return e.data;alert("Something went wrong (getConnections) (probably trying to get connections without being logged in)")})).then((function(e){d(e)}))}),[f,y]),Object(n.useEffect)((function(){k("/getLongConnections?count="+(null!==u?u.length:0)).then((function(e){e&&d(e),c(!o)}))}),[o]),u?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{position:"fixed",bottom:"45px",right:"5px",width:"200px",maxWidth:"45%",display:"none",zIndex:"33"},id:"connections"},r.a.createElement(xe,{connections:u,chat:y,setChat:S,setChatWindow:T,chatWindow:F,chatUsername:w,setChatUsername:N})),F?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex",flexDirection:"column-reverse",position:"fixed",bottom:"48px",right:"203px",width:"200px",maxWidth:"40%",backgroundColor:"gray",height:"auto",maxHeight:"400px",marginRight:"10px",borderRadius:"10px",zIndex:"33"}},r.a.createElement(Oe,{socket:t,chat:y,chatWindow:F,chatUsername:w}),r.a.createElement("div",{style:{backgroundColor:"transparent",margin:"10px",position:"absolute",top:"-40px"}},r.a.createElement("h3",null,w)))):"",r.a.createElement("button",{className:"btn btn-info",onClick:function(){!function(){var e=document.getElementById("connections");"none"===e.style.display?e.style.display="block":e.style.display="none"}(),b(!f),T(!0!==F&&F)},style:{width:"200px",maxWidth:"45%",height:"40px",backgroundColor:"gray",position:"fixed",bottom:"5px",right:"5px",textAlign:"center",zIndex:"32"}},"Connections (",u.length,")")):r.a.createElement("h1",null,"Loading")};var we=function(){var e=Object(E.getUser)(),t=Object(n.useState)(e),a=Object(i.a)(t,2),l=a[0],o=a[1],m=Object(n.useState)(!1),d=Object(i.a)(m,2),p=d[0],g=d[1],f=Object(n.useState)(null),b=Object(i.a)(f,2),h=b[0],v=b[1],y=null;return Object(n.useEffect)((function(){"null"!=Object(E.getToken)()&&Object(E.getToken)()&&((y=u.a.connect("http://localhost:3001")).emit("logIn",{token:Object(E.getToken)()}),v(y))}),[l]),r.a.createElement(r.a.Fragment,null,r.a.createElement(c.a,null,r.a.createElement(q,{state:l,setState:o,popupState:p,setPopupState:g,socketState:h}),"null"!=Object(E.getToken)()&&Object(E.getToken)()?r.a.createElement(r.a.Fragment,null,r.a.createElement(je,{socket:h})):"",r.a.createElement(s.c,null,r.a.createElement(s.a,{path:"/myProfile/profile"},r.a.createElement(ue,{setState:o,state:l})),r.a.createElement(s.a,{path:"/myProfile/likes"},r.a.createElement(be,{setState:o,state:l})),r.a.createElement(s.a,{path:"/myProfile/visits"},r.a.createElement(he,{setState:o,state:l})),r.a.createElement(s.a,{path:"/confirmEmail"},r.a.createElement(Z,{state:l,action:"confirmEmail",setPopupState:g})),r.a.createElement(s.a,{path:"/resetPassword"},r.a.createElement(Z,{state:l,action:"resetPassword",setPopupState:g})),r.a.createElement(s.a,{path:"/apiLogin"},r.a.createElement(Z,{state:l,setState:o,action:"apiLogin",setPopupState:g})),r.a.createElement(s.a,{path:"/apiRegister"},r.a.createElement(Z,{state:l,action:"apiRegister",setPopupState:g})),r.a.createElement(s.a,{path:"/map"},r.a.createElement(Se,null)),r.a.createElement(s.a,{path:"/"},r.a.createElement(Z,{state:l})))))};o.a.render(r.a.createElement("div",{className:"container-fluid"},r.a.createElement(we,null)),document.getElementById("root"))},33:function(e){e.exports=JSON.parse('{"a":{"noLikes":"Like!","youLike":"Unlike","theyLike":"Connect!","mutualLike":"Disconnect"},"b":[{"name":"matchRating","display":"Best match","key":"matchRating","order":1},{"name":"distance","display":"Distance","key":"distance","order":1},{"name":"fameAsc","display":"Fame ascending","key":"fame","order":1},{"name":"fameDesc","display":"Fame descending","key":"fame","order":-1},{"name":"ageAsc","display":"Age ascending","key":"age","order":1},{"name":"ageDesc","display":"Age descending","key":"age","order":-1},{"name":"tags","display":"Common tags","key":"commonTags","order":-1}]}')},51:function(e){e.exports=JSON.parse('{"a":"AIzaSyCfjYLjuvgWmwl5v6XrIncMh3hnnUgoKcg"}')}},[[108,1,2]]]);
//# sourceMappingURL=main.fe6d7114.chunk.js.map